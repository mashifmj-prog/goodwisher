// Helper
function $(id){return document.getElementById(id);}
let selectedRating = 0;

// Messages object with full translations
const messages = {
  en: {
    birthday: [
      "Happy Birthday! ЁЯОЙ", "Wishing you a fantastic day filled with joy!", "Celebrate your special day to the fullest!", 
      "May your year ahead be amazing!", "Cheers to another wonderful year!", "Hope all your wishes come true!", 
      "Have a wonderful birthday celebration!", "Enjoy every moment of your special day!", "Wishing you love and happiness!", 
      "Make this birthday unforgettable!"
    ],
    anniversary: [
      "Happy Anniversary! ЁЯТХ", "May your love continue to grow!", "Wishing you many more years together!", 
      "Cheers to your lasting love!", "Celebrate this special milestone!", "May your bond strengthen every year!", 
      "Happy Anniversary to a beautiful couple!", "Love and happiness to you both!", "Here's to endless memories together!", 
      "Wishing you joy and laughter always!"
    ],
    // Add other 11 occasions similarly with 10 messages each
    condolences: [
      "Sending heartfelt condolences in this time of loss. ЁЯХКя╕П", 
      "Our thoughts are with you and your family.", 
      "Wishing you comfort and peace during this difficult time.", 
      "May memories bring you solace.", 
      "Our hearts go out to you.", 
      "Thinking of you in these hard times.", 
      "Wishing you strength and healing.", 
      "May you find peace and support.", 
      "Holding you close in thoughts and prayers.", 
      "Sending love and sympathy to you."
    ],
    // ... repeat for motivation, good-luck, appreciation, farewell, encouragement, love, get-well, thank-you, vacation, congrats
  },
  es: {
    birthday: [
      "┬бFeliz cumplea├▒os! ЁЯОЙ", "┬бTe deseo un d├нa fant├бstico lleno de alegr├нa!", "┬бCelebra tu d├нa especial al m├бximo!", 
      "┬бQue tu a├▒o venidero sea incre├нble!", "┬бSalud por otro a├▒o maravilloso!", "┬бQue todos tus deseos se hagan realidad!", 
      "┬бQue tengas una maravillosa celebraci├│n de cumplea├▒os!", "┬бDisfruta cada momento de tu d├нa especial!", "┬бTe deseo amor y felicidad!", 
      "┬бHaz que este cumplea├▒os sea inolvidable!"
    ],
    anniversary: [
      "┬бFeliz aniversario! ЁЯТХ", "┬бQue su amor siga creciendo!", "┬бTe deseamos muchos m├бs a├▒os juntos!", 
      "┬бSalud por su amor duradero!", "┬бCelebren este hito especial!", "┬бQue su v├нnculo se fortalezca cada a├▒o!", 
      "┬бFeliz aniversario a una pareja hermosa!", "┬бAmor y felicidad para ambos!", "┬бPor infinitos recuerdos juntos!", 
      "┬бLes deseamos alegr├нa y risas siempre!"
    ],
    condolences: [
      "Enviando condolencias en este tiempo de p├йrdida. ЁЯХКя╕П", 
      "Nuestros pensamientos est├бn contigo y tu familia.", 
      "Dese├бndote consuelo y paz en este momento dif├нcil.", 
      "Que los recuerdos te brinden consuelo.", 
      "Nuestros corazones est├бn contigo.", 
      "Pensando en ti en estos momentos dif├нciles.", 
      "Dese├бndote fuerza y sanaci├│n.", 
      "Que encuentres paz y apoyo.", 
      "Te tenemos presente en pensamientos y oraciones.", 
      "Envi├бndote amor y simpat├нa."
    ],
    // ... repeat other occasions
  },
  zh: {
    birthday: [
      "чФЯцЧех┐лф╣Р! ЁЯОЙ", "чеЭф╜ацЬЙф╕Аф╕кхЕЕц╗бцмвф╣РчЪДч╛Охе╜ф╕Ахдй!", "х░╜цГЕх║ЖчеЭф╜ачЪДчЙ╣хИлцЧехнР!", 
      "цД┐ф╜ацЬкцЭечЪДф╕Ах╣┤ч▓╛х╜йч║╖хСИ!", "ф╕║хПжф╕Аф╕кч╛Охе╜чЪДф╕Ах╣┤х╣▓цЭп!", "х╕МцЬЫф╜ачЪДцЙАцЬЙцД┐цЬЫцИРчЬЯ!", 
      "чеЭф╜ацЬЙф╕Аф╕кч╛Охе╜чЪДчФЯцЧех║ЖчеЭ!", "ф║лхПЧф╜ачЙ╣хИлцЧехнРчЪДцпПф╕АхИ╗!", "чеЭф╜ачИ▒ф╕Ох╣╕чжП!", 
      "шойш┐Щф╕кчФЯцЧещЪ╛х┐Ш!"
    ],
    anniversary: [
      "хСих╣┤х┐лф╣Р! ЁЯТХ", "цД┐ф╜аф╗мчЪДчИ▒цЧечЫКхвЮщХ┐!", "чеЭф╜аф╗мхЕ▒х║жцЫ┤хдЪч╛Охе╜цЧ╢хЕЙ!", 
      "ф╕║ф╜аф╗мщХ┐ф╣ЕчЪДчИ▒х╣▓цЭп!", "х║ЖчеЭш┐Щф╕кчЙ╣хИлчЪДщЗМчиЛчвС!", "цД┐ф╜аф╗мчЪДцДЯцГЕцпПх╣┤щГ╜цЫ┤хКац╖▒хОЪ!", 
      "чеЭф╕Ахп╣ч╛Оф╕╜чЪДцГЕф╛гхСих╣┤х┐лф╣Р!", "чеЭф╜аф╗мчИ▒ф╕Ох╣╕чжП!", "цД┐ф╜аф╗мхЕ▒х║жцЧах░╜ч╛Охе╜хЫЮх┐Ж!", 
      "чеЭф╜аф╗мц░╕ш┐Ьх┐лф╣Рф╕ОцмвчмС!"
    ],
    condolences: [
      "хЬицндщАБф╕КшпЪцМЪчЪДцЕ░щЧо ЁЯХКя╕П", "цИСф╗мф╕Оф╜ахТМф╜ачЪДхо╢ф║║хРМхЬиуАВ", "хЬиш┐ЩшЙ░щЪ╛цЧ╢хИ╗я╝МчеЭф╜ах╣│хоЙф╕ОхоЙцЕ░уАВ", 
      "цД┐хЫЮх┐Жх╕жч╗Щф╜ахоЙцЕ░уАВ", "цИСф╗мчЪДх┐Гф╕Оф╜ахРМхЬиуАВ", "хЬиш┐Щф║ЫхЫ░щЪ╛цЧ╢цЬЯцГ│чЭАф╜ауАВ", 
      "чеЭф╜ахЭЪх╝║ф╕ОчЦЧцДИуАВ", "цД┐ф╜ацЙ╛хИ░х╣│щЭЩхТМцФпцМБуАВ", "хЬицАЭх┐╡ф╕ОчеИче╖ф╕нф╕Оф╜ахРМхЬиуАВ", 
      "щАБф╕КчИ▒ф╕ОцЕ░щЧоуАВ"
    ],
    // ... repeat other occasions
  },
  hi: {
    birthday: [
      "рдЬрдиреНрдорджрд┐рди рдореБрдмрд╛рд░рдХ рд╣реЛ! ЁЯОЙ", "рдЖрдкрдХрд╛ рджрд┐рди рдЦреБрд╢рд┐рдпреЛрдВ рд╕реЗ рднрд░рд╛ рд╣реЛ!", "рдЕрдкрдиреЗ рдЦрд╛рд╕ рджрд┐рди рдХрд╛ рдкреВрд░рд╛ рдЖрдирдВрдж рд▓реЗрдВ!", 
      "рдЖрдиреЗ рд╡рд╛рд▓рд╛ рд╕рд╛рд▓ рдЖрдкрдХреЗ рд▓рд┐рдП рд╢рд╛рдирджрд╛рд░ рд╣реЛ!", "рдПрдХ рдФрд░ рд╢рд╛рдирджрд╛рд░ рд╕рд╛рд▓ рдХреЗ рд▓рд┐рдП рдЪреАрдпрд░реНрд╕!", "рдЖрдкрдХреА рд╕рднреА рдЗрдЪреНрдЫрд╛рдПрдБ рдкреВрд░реА рд╣реЛрдВ!", 
      "рдЖрдкрдХреА рд╢рд╛рдирджрд╛рд░ рдЬрдиреНрдорджрд┐рди рд╕рдорд╛рд░реЛрд╣ рдХреА рд╢реБрднрдХрд╛рдордирд╛рдПрдБ!", "рдЕрдкрдиреЗ рдЦрд╛рд╕ рджрд┐рди рдХреЗ рд╣рд░ рдкрд▓ рдХрд╛ рдЖрдирдВрдж рд▓реЗрдВ!", "рдЖрдкрдХреЛ рдкреНрдпрд╛рд░ рдФрд░ рдЦреБрд╢реА рдорд┐рд▓реЗ!", 
      "рдЗрд╕ рдЬрдиреНрдорджрд┐рди рдХреЛ рдЕрд╡рд┐рд╕реНрдорд░рдгреАрдп рдмрдирд╛рдПрдВ!"
    ],
    anniversary: [
      "рд╡рд┐рд╡рд╛рд╣ рд╡рд░реНрд╖рдЧрд╛рдВрда рдХреА рд╢реБрднрдХрд╛рдордирд╛рдПрдБ! ЁЯТХ", "рдЖрдкрдХрд╛ рдкреНрдпрд╛рд░ рд╣рд░ рд╕рд╛рд▓ рдмрдврд╝рддрд╛ рд░рд╣реЗ!", "рдЖрдкрдХреЛ рдФрд░ рдХрдИ рд╡рд░реНрд╖реЛрдВ рдХреА рдЦреБрд╢рд┐рдпрд╛рдБ рдорд┐рд▓реЗрдВ!", 
      "рдЖрдкрдХреЗ рд▓рдВрдмреЗ рдкреНрдпрд╛рд░ рдХреЗ рд▓рд┐рдП рдЪреАрдпрд░реНрд╕!", "рдЗрд╕ рдЦрд╛рд╕ рдореМрдХреЗ рдХреЛ рдордирд╛рдПрдВ!", "рдЖрдкрдХрд╛ рдмрдВрдзрди рд╣рд░ рд╕рд╛рд▓ рдордЬрдмреВрдд рд╣реЛ!", 
      "рдПрдХ рд╕реБрдВрджрд░ рдЬреЛрдбрд╝реЗ рдХреЛ рд╡рд░реНрд╖рдЧрд╛рдВрда рдХреА рд╢реБрднрдХрд╛рдордирд╛рдПрдБ!", "рдЖрдк рджреЛрдиреЛрдВ рдХреЛ рдкреНрдпрд╛рд░ рдФрд░ рдЦреБрд╢реА рдорд┐рд▓реЗ!", "рдЕрдирдВрдд рдпрд╛рджреЛрдВ рдХреЗ рд▓рд┐рдП рдЪреАрдпрд░реНрд╕!", 
      "рд╣рдореЗрд╢рд╛ рдЦреБрд╢рд┐рдпрд╛рдБ рдФрд░ рд╣рдВрд╕реА рдмрдиреА рд░рд╣реЗ!"
    ],
    condolences: [
      "рдЗрд╕ рдХрдард┐рди рд╕рдордп рдореЗрдВ рд╣рд╛рд░реНрджрд┐рдХ рд╕рдВрд╡реЗрджрдирд╛рдПрдБ ЁЯХКя╕П", "рд╣рдо рдЖрдкрдХреЗ рдФрд░ рдЖрдкрдХреЗ рдкрд░рд┐рд╡рд╛рд░ рдХреЗ рд╕рд╛рде рд╣реИрдВред", "рдЗрд╕ рдХрдард┐рди рд╕рдордп рдореЗрдВ рдЖрдкрдХреЛ рд╢рд╛рдВрддрд┐ рдФрд░ рдЖрд░рд╛рдо рдорд┐рд▓реЗред", 
      "рдпрд╛рджреЗрдВ рдЖрдкрдХреЛ рд╕рд╛рдВрддреНрд╡рдирд╛ рджреЗрдВред", "рд╣рдорд╛рд░рд╛ рджрд┐рд▓ рдЖрдкрдХреЗ рд╕рд╛рде рд╣реИред", "рдЗрди рдХрдард┐рди рд╕рдордпреЛрдВ рдореЗрдВ рдЖрдкрдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реЛрдЪ рд░рд╣реЗ рд╣реИрдВред", 
      "рдЖрдкрдХреЛ рд╢рдХреНрддрд┐ рдФрд░ рд╣реАрд▓рд┐рдВрдЧ рдорд┐рд▓реЗред", "рдЖрдк рд╢рд╛рдВрддрд┐ рдФрд░ рд╕рдорд░реНрдерди рдкрд╛рдПрдВред", "рд╕реЛрдЪ рдФрд░ рдкреНрд░рд╛рд░реНрдердирд╛рдУрдВ рдореЗрдВ рдЖрдкрдХреЗ рд╕рд╛рде рд╣реИрдВред", 
      "рдЖрдкрдХреЛ рдкреНрдпрд╛рд░ рдФрд░ рд╕рд╣рд╛рдиреБрднреВрддрд┐ рднреЗрдЬ рд░рд╣реЗ рд╣реИрдВред"
    ],
    // ... repeat other occasions
  },
  af: {
    birthday: [
      "Gelukkige verjaarsdag! ЁЯОЙ", "Mag jou dag gevul wees met vreugde!", "Vier jou spesiale dag ten volle!", 
      "Mag die jaar wat kom wonderlik wees!", "Gesondheid op nog 'n wonderlike jaar!", "Mag al jou wense waar word!", 
      "Geniet 'n wonderlike verjaarsdagviering!", "Geniet elke oomblik van jou spesiale dag!", "Ek wens jou liefde en geluk toe!", 
      "Maak hierdie verjaarsdag onvergeetlik!"
    ],
    anniversary: [
      "Gelukkige herdenking! ЁЯТХ", "Mag julle liefde met elke jaar groei!", "Wens julle nog baie jare saam!", 
      "Gesondheid op julle lang liefde!", "Vier hierdie spesiale mylpaal!", "Mag julle band elke jaar sterker word!", 
      "Gelukkige herdenking aan 'n pragtige paartjie!", "Liefde en geluk aan julle beide!", "Op eindelose herinneringe saam!", 
      "Wens julle altyd vreugde en lag toe!"
    ],
    condolences: [
      "Stuur innige meegevoel in hierdie tyd van verlies ЁЯХКя╕П", "Ons dink aan jou en jou familie.", "Mag jy troos en vrede vind in hierdie moeilike tyd.", 
      "Mag herinneringe vir jou troos bring.", "Ons harte is by jou.", "Dink aan jou in hierdie moeilike tye.", 
      "Wens jou krag en genesing toe.", "Mag jy vrede en ondersteuning vind.", "Hou jou naby in gedagtes en gebede.", 
      "Stuur liefde en simpatie aan jou."
    ],
    // ... repeat other occasions
  }
};

// THEME TOGGLE
function setThemeIcon() {
  const p = $('themeIconPath');
  const isDark = document.body.dataset.theme === 'dark';
  p.setAttribute('d', isDark
    ? 'M21.64 13a9 9 0 11-9-9c0 4.97 4.03 9 9 9z'
    : 'M12 2a10 10 0 100 20 10 10 0 000-20z'
  );
}
function toggleTheme() {
  const body = document.body;
  const newTheme = body.dataset.theme === 'dark' ? 'light' : 'dark';
  body.dataset.theme = newTheme;
  localStorage.setItem('theme', newTheme);
  setThemeIcon();
}

// Display message in textarea
function displayMessage() {
  const occ = $('occasion').value;
  const lang = $('language').value;
  if (!occ) {
    $('message').textContent = '';
    $('customMessage').value = '';
    return;
  }
  const occMessages = messages[lang][occ];
  if (!occMessages || occMessages.length === 0) {
    $('message').textContent = 'No messages available';
    $('customMessage').value = '';
    return;
  }
  const randomIndex = Math.floor(Math.random() * occMessages.length);
  const msg = occMessages[randomIndex];
  $('message').textContent = msg;
  $('customMessage').value = msg; // only message body, signature hidden
}

// Next Message
function nextMessage() {
  displayMessage();
}

// Add sender/recipient
function updateMessageWithName() {
  const r = $('recipientName').value.trim();
  const s = $('senderName').value.trim();
  let msg = $('customMessage').value;
  if (!msg) return;
  let full = msg;
  if (r) full = `Hi ${r},\n\n${msg}`;
  if (s) full += `\n\nRegards\n${s}`;
  $('customMessage').value = full;
}

// Copy
function copyMessage() {
  const text = $('customMessage').value;
  if (!text) return alert('No message!');
  navigator.clipboard.writeText(text);
  alert('Copied!');
}

// Clear content
function clearContent() {
  $('customMessage').value = '';
  $('message').textContent = '';
}

// Emoji popup (generic or occasion-specific)
function openEmoji() {
  alert("Emoji popup here - can later implement relevant emojis per occasion.");
}

// INIT
window.addEventListener('DOMContentLoaded', () => {
  const saved = localStorage.getItem('theme') || 'light';
  document.body.dataset.theme = saved;
  setThemeIcon();
  $('themeToggle').addEventListener('click', toggleTheme);
  $('language').addEventListener('change', displayMessage);
  $('occasion').addEventListener('change', displayMessage);
});
